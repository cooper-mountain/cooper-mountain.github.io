<head>
	<link rel="stylesheet" href="./tapList.css" />
		<link rel="stylesheet" href="./fontawesome-pro-5.8.2-web/css/all.css" />
	
	<style>
		html { font-size: 200%; // this is usually 16px by default }
	
		body {
			display: grid;
			grid-template-columns: 50% 50%;
		}
		
		@media only screen and (max-width: 1900px) {
			body {
				grid-template-columns: 100%;
			}
		}
		
		aside {
			margin: 15px;
			padding: 15px;
			border: 3px solid #FFFFFF;
			border-radius: 5px;
			display: grid;
			grid-template-columns: 70% 30%;
		}
		
		h4 {
			color: #ffa94d;
			margin: 0px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		h5 {
			margin: 0px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}
		
		p {
		}
		
		
		.content {

		}
		
		.price-stack {
			text-align: center;
			margin: 0px 10px;
		}
		
		.prices {
			font-size: 1em;
			text-align: right;
		}
		
		.price {
			font-size: 2em;
			color: #2E363F;
			padding-top: 10px;
			font-size: 80%;
			font-weight: bold;
		}
		
		.price-pint {
			top: 8px;
		}
		
		.stats {
			grid-column: span 2;
		}

	</style>
</head>


<script>

	function loadBrews() {
		var brews = JSON.parse(this.responseText);
		
		var currentHour = brews.schedule[new Date().getHours()];

		document.body.innerHTML = `
			${brews.brews.map(brew => `
				<aside>
					<div class="content">
						<h4>${brew.name}</h4>
						<h5>${brew.style}</h5>
						${brew.brewery && brew.breweryLocation ? `<h5>${brew.brewery} (${brew.breweryLocation})</h5>`: ''}
					</div>
					<div class="prices">
						${brew.prices.filter(price => price.type === currentHour).sort((a,b) => a.value > b.value).map(price => `
							<span class="fa-stack price-stack">
								<span class="fas fa-3x ${getIcon(price['size'])}"></span>
								<span class="fa-stack-1x price price-${price['size']}">$${price['value']}</span>
							</span>	
						`).join('')}
					</div>
					<code class="stats">ABV: ${brew.abv}% | IBU: ${brew.ibu}</code>
				</aside>
			`).join('')}
		`;
		
	}
	
	function getIcon(priceSize) {
		if (priceSize === 'pint') {
			return "fa-glass";
		} else if (priceSize === 'glass') {
			return "fa-wine-glass-alt";
		} else {
			return "fa-cirlce"
		}
	}

	function loadPage() {
		var request = new XMLHttpRequest();
		request.addEventListener('load', loadBrews);
		request.open("GET", "/brews.json");
		request.send();
	}

	loadPage();

	setInterval(loadPage, 60000);

</script>

</script>

<body>

</body>
