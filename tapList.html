<head>
	<link rel="stylesheet" href="./tapList.css" />
		<link rel="stylesheet" href="./fontawesome-pro-5.8.2-web/css/all.css" />
	
	<style>
		html { font-size: 200%; // this is usually 16px by default }
	
		body {
			display: grid;
			grid-template-columns: 50% 50%;
		}
		
		aside {
			margin: 15px;
			padding: 15px;
			border: 3px solid #FFFFFF;
			border-radius: 5px;
			display: grid;
			grid-template-columns: 70% 30%;
		}
		
		h4 {
			color: #ffa94d;
			margin: 0px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		h5 {
			margin: 0px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}
		
		p {
		}
		
		
		.content {

		}
		
		.price-stack {
			margin: 0px 10px;
		}
		
		.prices {
		font-size: 1em;
			text-align: right;
		}
		
		.price {
			font-size: 2em;
			color: #2E363F;
			padding-top: 10px;
			font-size: 80%;
			font-weight: bold;
		}
		
		.stats {
			grid-column: span 2;
		}

	</style>
</head>


<script>

	function loadBrews() {
		var brews = JSON.parse(this.responseText);
		
		var currentHour = brews.schedule[new Date().getHours()];

		document.body.innerHTML = "";
		for (var index in brews.brews) {
			var brew = brews.brews[index];

			var brewAside = document.createElement('aside');

			var brewDiv = document.createElement('div');
			brewDiv.classList.add('content');

			var brewName = document.createElement('h4');
			brewName.innerText = brew.name;
			brewDiv.appendChild(brewName);

			var style = document.createElement('h5');
			style.innerText = brew.style;
			brewDiv.appendChild(style);
			
			if (brew.brewery && brew.breweryLocation) {
				var brewery = document.createElement('h5');
				brewery.innerText = brew.brewery + " (" + brew.breweryLocation + ")";
				brewDiv.appendChild(brewery);
			}

			var description = document.createElement('p');
			description.innerText = brew.description;
			//brewDiv.appendChild(description);


			brewAside.appendChild(brewDiv);
			
			
			var prices = document.createElement('div');
			prices.classList.add('prices');
			var priceArray = brew.prices.sort((a,b) => a.value > b.value)
			for (var pricesIndex in priceArray) {
				var price = brew.prices[pricesIndex];
				if (price.type === currentHour) {
					console.log(price);
					prices.innerHTML += '<span class="fa-stack price-stack"><span class="fas fa-3x ' + getIcon(price['size']) + '"></span><span class="fa-stack-1x price">$' + price.value + '</span></span>';
				}
			}
			brewAside.appendChild(prices);
			
			var stats = document.createElement('code');
			stats.classList.add('stats');
			stats.innerText = 'ABV: ' + brew.abv + "% | IBU: " + brew.ibu;
			brewAside.appendChild(stats);

			document.body.appendChild(brewAside);
		}
	}
	
	function getIcon(priceSize) {
		if (priceSize === 'pint') {
			return "fa-glass";
		} else if (priceSize === 'glass') {
			return "fa-wine-glass-alt";
		} else {
			return "fa-cirlce"
		}
	}

	function loadPage() {
		var request = new XMLHttpRequest();
		request.addEventListener('load', loadBrews);
		request.open("GET", "/brews.json");
		request.send();
	}

	loadPage();

	setInterval(loadPage, 60000);

</script>

</script>

<body>

</body>
